(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{101:function(e,t){},141:function(e,t,a){"use strict";a.r(t);var s,n=a(0),r=a.n(n),i=a(60),l=a.n(i),c=a(62),o=a(7),m=(a(71),a(11)),u=a(12),d=a(4),g=a(14),f=a(13),h=a(61),p=a.n(h),v=0,b=1,E=2,x=a(35),S=a(65),k=a(17),N=a.n(k),C=function(e){var t=e.name,a=e.imgSrc;return r.a.createElement("div",{className:"d-flex align-items-center"},r.a.createElement("img",{src:a||N.a,className:"avatarsUserIdent rounded-circle",alt:"User Avatar"}),r.a.createElement("div",{className:"ml-3"},t))},T=function(e){var t=e.user,a=e.LikeUserToggle,s=e.ToPageChat,n=t.likeThem?r.a.createElement("i",{className:"fas fa-heart fa-lg"}):r.a.createElement("i",{className:"far fa-heart fa-lg"}),i=t.likeThem&&t.likesMe,l=i?r.a.createElement("i",{className:"fas fa-comment fa-lg fa-fw"}):r.a.createElement("i",{className:"fas fa-comment-slash fa-lg fa-fw"}),c=t.unreadMsg?r.a.createElement("span",{className:"notificationBadge"}):"";return r.a.createElement("div",{className:"d-flex justify-content-between align-items-center"},r.a.createElement(C,{name:t.name,imgSrc:t.imgSrc}),r.a.createElement("div",{className:"d-flex align-items-center"},r.a.createElement("button",{className:"btn",onClick:function(){a(t.id,!t.likeThem)}},n),r.a.createElement("button",{className:"btn position-relative",onClick:function(){s(t)},disabled:!i},l,c)))},y=a(20),w=a.n(y),U=function(e){var t=e.users,a=e.LikeUserToggle,s=e.ToPageChat;return r.a.createElement("div",{className:"h-100 w-100 d-flex flex-column"},r.a.createElement("h1",{className:"text-center text-white"},"Users"),r.a.createElement("ul",{className:"list-group bg-secondary p-2 flex-grow-1 position-relative"},r.a.createElement(w.a,{className:"FullSpreadAbsElem",scrollViewClassName:"pad10"},t.map((function(e,t){return r.a.createElement("li",{className:"list-group-item m-0Auto mw1000 innerScrollItem",key:t},r.a.createElement(T,{user:e,LikeUserToggle:a,ToPageChat:s}))})))))},I=function(e){var t=e.ToPageUsers,a=e.user_Chat,s=e.user_Chat_Active;return r.a.createElement("div",{className:"text-white d-flex align-items-center pt-3 pb-3"},r.a.createElement("button",{onClick:t,className:"btn ml-2 text-white"},r.a.createElement("i",{className:"fas fa-arrow-left"})),r.a.createElement("div",{className:"ml-2 fontSize150"},r.a.createElement(C,{name:a.name+(s?"":" [account deleted]"),imgSrc:a.imgSrc})))},j=a(32),_=a.n(j),O=function(e){var t=e.message,a=t.msgText,s=t.fromSender;return console.log("Message created. From sender: ".concat(s,', msg text: "').concat(a,'"')),s?r.a.createElement("div",{className:"d-flex justify-content-end mt-3"},r.a.createElement("div",{className:"messageBox bgLightBlue fromSelf"},r.a.createElement("div",{className:"messageText text-white"},_.a.emojify(a)))):r.a.createElement("div",{className:"d-flex justify-content-start mt-3"},r.a.createElement("div",{className:"messageBox bg-white fromOther"},r.a.createElement("div",{className:"messageText"},_.a.emojify(a))))},A=function(e){Object(g.a)(a,e);var t=Object(f.a)(a);function a(){var e;Object(m.a)(this,a);for(var s=arguments.length,n=new Array(s),r=0;r<s;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))).state={msgText:""},e}return Object(u.a)(a,[{key:"SendMessage",value:function(e){e.preventDefault(),console.log('SendMessage called in Chat.js, msgText: "'.concat(this.state.msgText,'" to user: "').concat(this.props.user_Chat.id,'"')),this.state.msgText&&(this.props.socket.emit("SendMessage",{msgText:this.state.msgText,chatPtnrID:this.props.user_Chat.id}),this.props.user_Chat_Active||console.warn("Message not sent, that user has been removed from the server."),this.props.OnSendMessage(this.props.user_Chat.id,this.state.msgText),this.setState({msgText:""}))}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"h-100 d-flex flex-column justify-content-between"},r.a.createElement("div",null,r.a.createElement("div",{className:"mw1000 m-0Auto"},r.a.createElement(I,{ToPageUsers:this.props.ToPageUsers,user_Chat:this.props.user_Chat,user_Chat_Active:this.props.user_Chat_Active}))),r.a.createElement("div",{className:"flex-grow-1 bg-secondary"},r.a.createElement("div",{className:"mw1000 m-0Auto h-100 position-relative"},r.a.createElement(w.a,{className:"FullSpreadAbsElem",scrollViewClassName:"pad10"},this.props.user_Chat.messages.map((function(e,t){return r.a.createElement("div",{className:"innerScrollItem",key:t},r.a.createElement(O,{message:e}))}))))),r.a.createElement("div",{className:"bg-secondary"},r.a.createElement("form",{className:"mw1000 m-0Auto d-flex align-items-stretch"},r.a.createElement("input",{className:"form-control form-control-lg flex-grow-1 noBorder",type:"text",placeholder:"message",value:this.props.user_Chat_Active?this.state.msgText:"",onChange:function(t){return e.setState({msgText:t.target.value})},onKeyPress:function(t){return"Enter"===t.key?e.SendMessage(t):null},disabled:!this.props.user_Chat_Active}),r.a.createElement("button",{className:"btn noBorder bg-white",onClick:function(t){return e.SendMessage(t)},disabled:!this.props.user_Chat_Active},r.a.createElement("i",{className:"fas fa-paper-plane fa-lg"})))))}}]),a}(n.Component),P=function(){return r.a.createElement("div",null)},M=function(e){Object(g.a)(a,e);var t=Object(f.a)(a);function a(e){var s;return Object(m.a)(this,a),(s=t.call(this,e)).state={page:v,users:[],user_Chat:null},e.socket.on("RecNewUser",(function(e){console.log('Adding user: "'.concat(e.id,'"')),s.setState({users:[].concat(Object(S.a)(s.state.users),[e])})})),e.socket.on("RemoveUser",(function(e){console.log('Removing user: "'.concat(e,'"'));var t=s.state.users.findIndex((function(t){return t.id===e}));s.state.users.splice(t,1),s.setState({users:s.state.users})})),e.socket.on("RecLikeToggle",(function(e){console.log('Liked by user: "'.concat(e.socketID,'"'));var t=s.state.users.findIndex((function(t){return t.id===e.socketID}));s.state.users[t].likesMe=e.likesMe,s.setState({users:s.state.users})})),e.socket.emit("GetUsers",{},(function(e){for(var t=0;t<e.length;t++)console.log('Adding users: "'.concat(e[t].id,'"'));s.setState({users:e})})),e.socket.on("RecMessage",(function(e){console.log('Received message: "'.concat(e.msgText,'" from user: "').concat(e.senderID,'"'));var t=s.state.users.findIndex((function(t){return t.id===e.senderID}));s.state.users[t].messages.push({msgText:e.msgText,fromSender:!1});var a=!1;s.state.user_Chat&&s.state.user_Chat.id===e.senderID&&(a=!0),a||(s.state.users[t].unreadMsg=!0),s.setState({users:s.state.users})})),s.ToPageUsers=s.ToPageUsers.bind(Object(d.a)(s)),s.LikeUserToggle=s.LikeUserToggle.bind(Object(d.a)(s)),s.ToPageChat=s.ToPageChat.bind(Object(d.a)(s)),s.OnSendMessage=s.OnSendMessage.bind(Object(d.a)(s)),s}return Object(u.a)(a,[{key:"ToPageUsers",value:function(){this.setState({user_Chat:null,page:v})}},{key:"LikeUserToggle",value:function(e,t){this.props.socket.emit("LikeUserToggle",{userID:e,isLiked:t}),this.setState((function(a){return{users:a.users.map((function(a){return a.id===e?Object(x.a)({},a,{likeThem:t}):a}))}}))}},{key:"ToPageChat",value:function(e){this.setState((function(t){return{users:t.users.map((function(t){return t.id===e.id?Object(x.a)({},t,{unreadMsg:!1}):t})),user_Chat:e,page:b}}))}},{key:"OnSendMessage",value:function(e,t){console.log('Sent message: "'.concat(t,'" to user: "').concat(e,'"'));var a=this.state.users.findIndex((function(t){return t.id===e}));this.state.users[a].messages.push({msgText:t,fromSender:!0}),this.setState({users:this.state.users})}},{key:"render",value:function(){var e=this;if(this.state.page===v)return r.a.createElement(U,{users:this.state.users,LikeUserToggle:this.LikeUserToggle,ToPageChat:this.ToPageChat});if(this.state.page===b){var t=!0;return this.state.user_Chat&&-1===this.state.users.findIndex((function(t){return t.id===e.state.user_Chat.id}))&&(t=!1),r.a.createElement(A,{socket:this.props.socket,user_Chat:this.state.user_Chat,user_Chat_Active:t,OnSendMessage:this.OnSendMessage,ToPageUsers:this.ToPageUsers})}return this.state.page===E?r.a.createElement(P,null):void 0}}]),a}(n.Component),R=function(e){var t=e.percent,a={width:t+"%"};return r.a.createElement("div",{id:"ImageUploadBar",className:"progress position-absolute h-100 w-100"},r.a.createElement("div",{role:"progressbar",className:"progress-bar progress-bar-striped bg-success progress-bar-animated transitionNone",style:a,"aria-valuenow":t,"aria-valuemin":"0","aria-valuemax":"100"}))},L=window.URL||window.webkitURL,D=["jpg","jpeg","png","gif"],F=function(e){var t=e.GetImgDetails,a=e.imgSrc,s=e.disabled,n=e.willLoadFile,i=e.percent,l=n?r.a.createElement(R,{percent:i}):"";return r.a.createElement("div",{className:"mt-2"},r.a.createElement("img",{src:a,id:"AvatarSelected",className:"img-fluid rounded-circle mt-1 mb-1 mt-md-3 mb-md-3 mt-lg-5 mb-lg-5",alt:"User avatar"}),r.a.createElement("input",{id:"HiddenFileUploader",placeholder:"File",className:"d-none",type:"file",accept:"image/*",capture:"user",onChange:function(e){if(1===e.target.files.length){var a=e.target.value,s=a.slice(2+(a.lastIndexOf(".")-1>>>0));if(-1!==D.indexOf(s)){var n=e.target.files[0],r=new Image;r.onload=function(){console.log("img width: "+r.width+", height: "+r.height)},r.src=L.createObjectURL(n),t(s,n,r.src)}else alert("Image must have extension: jpg, jpeg, png, or gif")}else alert("Can only use 1 photo at a time.")},disabled:s}),r.a.createElement("button",{className:"btn btn-secondary btn-lg btn-block mt-2 position-relative",onClick:function(){document.getElementById("HiddenFileUploader").click()},disabled:s},r.a.createElement("span",null,"Upload picture"),l))};s=p()("localhost:5000");var B=function(e){Object(g.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).state={file:null,percent:0,disabled:!1,signedIn:!1},n.nameField=r.a.createRef(),n.fileExt="",n.fileSrc=N.a,n.slice=null,n.fileReader=null,s.on("ImageReqSlice",(function(e){var t=1e5*e.currentSlice;n.slice=n.state.file.slice(t,t+Math.min(1e5,n.state.file.size-t));var a=t/n.state.file.size*100;n.setState({percent:a}),n.fileReader.readAsArrayBuffer(n.slice)})),s.on("ImageUploadError",(function(e){console.log("Could not upload image due to error: ",e),n.fileReader.abort(),alert("Error uploading image, restoring default, my bad. :("),n.fileExt="",n.fileSrc=N.a,n.setState({file:null,disabled:!1,percent:0})})),s.on("ImageUploadEnd",(function(e){n.fileReader.onload=function(e){console.log("Image upload successful"),n.setState({file:null,percent:100}),s.emit("AddUser",{name:n.nameField.current.value,ext:n.fileExt},(function(){n.setState({signedIn:!0})}))},n.fileReader.readAsDataURL(n.state.file)})),n.SubmitProfile=n.SubmitProfile.bind(Object(d.a)(n)),n.GetImgDetails=n.GetImgDetails.bind(Object(d.a)(n)),n}return Object(u.a)(a,[{key:"SubmitProfile",value:function(e){var t=this;e.preventDefault();var a=this.nameField.current.value;""!==a?(this.setState({disabled:!0}),console.log("Submit clicked - Name: ".concat(a,", Ext: ").concat(this.fileExt,", src: ").concat(this.fileSrc,", file:"),this.state.file),null===this.state.file?s.emit("AddUser",{name:a,ext:this.fileExt},(function(){t.setState({signedIn:!0})})):(this.slice=this.state.file.slice(0,1e5),this.fileReader=new FileReader,this.fileReader.onload=function(e){s.emit("ImageUploadSlice",{ext:t.fileExt,name:a,type:t.state.file.type,size:t.state.file.size,data:e.target.result})},this.fileReader.readAsArrayBuffer(this.slice))):alert("Name required")}},{key:"GetImgDetails",value:function(e,t,a){console.log("Ext: ".concat(e,", src: ").concat(a,", file:"),t),this.fileExt=e,this.fileSrc=a,this.setState({file:t})}},{key:"render",value:function(){var e=this.state.disabled&&null!==this.state.file;return this.state.signedIn?r.a.createElement(M,{socket:s}):r.a.createElement("div",{className:"position-relative h-100"},r.a.createElement("div",{className:"container-fluid h-100 d-flex flex-column justify-content-center align-items-center"},r.a.createElement("div",null,r.a.createElement("h1",{className:"text-center text-white"},"Welcome"),r.a.createElement("hr",{className:"bg-light mt-1 mb-2 mt-md-2 mb-md-3 mt-lg-3 mb-lg-4"}),r.a.createElement("input",{type:"text",className:"form-control form-control-lg",placeholder:"Name",ref:this.nameField,onKeyPress:function(e){return"Enter"===e.key?e.target.blur():null},disabled:this.state.disabled})),r.a.createElement("div",null,r.a.createElement(F,{GetImgDetails:this.GetImgDetails,imgSrc:this.fileSrc,disabled:this.state.disabled,willLoadFile:e,percent:this.state.percent}),r.a.createElement("button",{className:"btn btn-primary btn-lg btn-block mt-2",onClick:this.SubmitProfile,disabled:this.state.disabled},"Sign In"))))}}]),a}(n.Component),G=function(){return r.a.createElement(c.a,null,r.a.createElement(o.a,{path:"/*",exact:!0,component:B}))};l.a.render(r.a.createElement(G,null),document.querySelector("#root"))},17:function(e,t,a){e.exports=a.p+"static/media/SpeechlessGuy.8d8d757b.png"},66:function(e,t,a){e.exports=a(141)},71:function(e,t,a){}},[[66,1,2]]]);
//# sourceMappingURL=main.6beda083.chunk.js.map